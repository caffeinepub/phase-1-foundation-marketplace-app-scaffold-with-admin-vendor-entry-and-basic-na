{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 57,
  "summary": "Proceeding from Phase 4 to Phase 5 work, starting the vendor discovery experience (public verified vendors directory + vendor storefront support).",
  "architectural_notes": [
    "Target stack: ICP/Caffeine with single Motoko backend canister + React frontend canister.",
    "Auth via Internet Identity for admin and vendors.",
    "Phase-1/early MVP scope explicitly excludes payments, DAOs, advanced dashboards/analytics, complex roles/permissions, and multi-organization until later phases.",
    "Deployment/upgrade stability: add stable storage + preupgrade/postupgrade (and conditional migration per policy) to ensure upgrade-safe persistence and unblock deployments when backend grows.",
    "Backlog decision: consolidate repeated upgrade-safety/stable-storage AR items into a single implementation pass (stable storage + preupgrade/postupgrade + conditional migration only if required)."
  ],
  "known_issues": [
    "Caffeine build/generation attempts have failed previously with 'AI was unable to fulfill/implement' errors; may require simplifying prompts or smaller phase-by-phase generation.",
    "Deployments may fail at the deployment/upgrade step if the backend state is not in stable storage with proper preupgrade/postupgrade hooks (upgrade-safety/migration required as backend APIs/state evolve)."
  ],
  "isFixRequest": false,
  "existing_features": [
    {
      "id": "feature-implement-a-phase-1-scoped-application-shell-for-a-multi-vendor-marketplace-with-two-user-types-admin-and-vendor-explicitly-limiting-functionality-to-foundation-only-no-payments-no-advanced-roles-permissions-system-no-analytics-no-daos-no-multi-organization-support",
      "title": "Implement a Phase 1 scoped application shell for a multi-vendor marketplace with two user types (Admin and Vendor), explicitly limiting functionality to foundation only (no payments, no advanced roles/permissions system, no analytics, no DAOs, no multi-organization support).",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-simple-authentication-entry-flow-using-internet-identity-that-lets-a-signed-in-user-proceed-as-either-an-admin-or-a-vendor-for-phase-1-this-can-be-a-lightweight-selection-step-after-login-no-complex-permission-matrix",
      "title": "Add a simple authentication entry flow using Internet Identity that lets a signed-in user proceed as either an Admin or a Vendor for Phase 1 (this can be a lightweight selection step after login; no complex permission matrix).",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-create-the-initial-page-structure-and-navigation-for-phase-1-with-placeholders-for-later-phases-1-landing-public-page-2-admin-area-placeholder-3-vendor-area-placeholder-4-public-product-listing-placeholder-page-read-only-placeholder-no-real-crud-yet",
      "title": "Create the initial page structure and navigation for Phase 1 with placeholders for later phases: (1) Landing/Public page, (2) Admin area placeholder, (3) Vendor area placeholder, (4) Public product listing placeholder page (read-only placeholder, no real CRUD yet).",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-apply-a-coherent-distinct-visual-theme-colors-typography-spacing-layout-appropriate-for-a-marketplace-foundation-and-use-it-consistently-across-all-phase-1-screens-avoid-blue-purple-as-primary-brand-colors-unless-explicitly-requested-later",
      "title": "Apply a coherent, distinct visual theme (colors, typography, spacing, layout) appropriate for a marketplace foundation and use it consistently across all Phase 1 screens. Avoid blue/purple as primary brand colors unless explicitly requested later.",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-frontend-to-replace-phase-1-placeholder-ui-with-phase-2-product-browsing-a-real-public-products-list-page-backed-by-the-new-backend-apis-including-basic-search-and-filtering",
      "title": "Update the frontend to replace Phase 1 placeholder UI with Phase 2 product browsing: a real public products list page backed by the new backend APIs, including basic search and filtering.",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-public-product-detail-page-route-and-ui-that-shows-a-single-product-s-information-and-its-vendor-display-name-when-available",
      "title": "Add a public product detail page route and UI that shows a single product’s information and its vendor display name (when available).",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-phase-2-vendor-onboarding-profile-management-in-the-vendor-area-replacing-the-phase-1-placeholder-with-real-vendor-profile-crud-for-the-signed-in-vendor",
      "title": "Implement Phase 2 vendor onboarding/profile management in the vendor area, replacing the Phase 1 placeholder with real vendor profile CRUD for the signed-in vendor.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-phase-2-vendor-product-management-in-the-vendor-area-create-edit-publish-unpublish-and-list-the-signed-in-vendor-s-products",
      "title": "Implement Phase 2 vendor product management in the vendor area: create, edit, publish/unpublish, and list the signed-in vendor’s products.",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "feature-replace-the-current-admin-placeholder-page-at-route-admin-with-a-functional-admin-vendor-management-ui-that-lets-an-authenticated-user-in-admin-mode-view-all-vendor-profiles-and-verify-vendors",
      "title": "Replace the current Admin placeholder page at route \"/admin\" with a functional Admin Vendor Management UI that lets an authenticated user in admin mode view all vendor profiles and verify vendors.",
      "reqIds": [
        "REQ-11"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-react-query-hooks-in-frontend-src-hooks-usemarketplacequeries-ts-for-admin-vendor-management-using-existing-backend-apis-to-a-fetch-all-vendor-profiles-and-b-verify-a-vendor-by-id-and-use-these-hooks-in-the-admin-ui",
      "title": "Implement React Query hooks in frontend/src/hooks/useMarketplaceQueries.ts for admin vendor management, using existing backend APIs to (a) fetch all vendor profiles and (b) verify a vendor by id, and use these hooks in the /admin UI.",
      "reqIds": [
        "REQ-12"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-product-detail-page-vendor-lookup-logic-to-use-the-new-backend-principal-vendor-profile-method-so-that-when-a-product-has-an-owner-principal-the-ui-shows-the-vendor-company-name-and-verified-badge-whenever-a-matching-vendor-profile-exists",
      "title": "Update the Product Detail page vendor lookup logic to use the new backend principal->vendor profile method so that, when a product has an owner principal, the UI shows the vendor company name (and verified badge) whenever a matching vendor profile exists.",
      "reqIds": [
        "REQ-14"
      ],
      "version": 1
    },
    {
      "id": "feature-replace-placeholder-frontend-connection-auth-query-hooks-with-real-backend-calls-update-frontend-src-hooks-usequeries-ts-so-usebackendstatus-calls-the-backend-status-method-usebackendrunning-calls-the-ping-method-and-returns-false-on-failure-and-usewhoami-is-enabled-and-calls-the-backend-whoami-method-when-an-identity-is-present",
      "title": "Replace placeholder frontend connection/auth query hooks with real backend calls: update frontend/src/hooks/useQueries.ts so useBackendStatus calls the backend status method, useBackendRunning calls the ping method (and returns false on failure), and useWhoAmI is enabled and calls the backend whoami method when an identity is present.",
      "reqIds": [
        "REQ-16"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-connection-status-card-ux-to-accurately-reflect-real-backend-auth-states-using-the-updated-hooks-including-clear-loading-and-error-states-for-backend-status-ping-and-whoami-checks",
      "title": "Update the Connection Status card UX to accurately reflect real backend/auth states using the updated hooks, including clear loading and error states for backend status, ping, and whoami checks.",
      "reqIds": [
        "REQ-17"
      ],
      "version": 1
    },
    {
      "id": "feature-wire-the-existing-frontend-react-query-hooks-in-frontend-src-hooks-usemarketplacequeries-ts-to-the-real-backend-product-methods-remove-placeholder-empty-array-null-returns-and-remove-placeholder-thrown-errors-including-usepublishedproducts-useproductbyid-usecallerproducts-usecreateproduct-and-useupdateproduct",
      "title": "Wire the existing frontend React Query hooks in frontend/src/hooks/useMarketplaceQueries.ts to the real backend product methods (remove placeholder empty-array/null returns and remove placeholder thrown errors), including: usePublishedProducts, useProductById, useCallerProducts, useCreateProduct, and useUpdateProduct.",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-update-user-facing-ui-copy-in-the-public-products-browsing-page-to-reflect-the-now-working-product-system-remove-or-adjust-any-backend-will-be-available-soon-phase-2-implementation-warning-messaging-that-is-no-longer-accurate",
      "title": "Update user-facing UI copy in the public products browsing page to reflect the now-working product system (remove or adjust any “backend will be available soon”/Phase 2 implementation warning messaging that is no longer accurate).",
      "reqIds": [
        "REQ-21"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-new-public-vendors-directory-page-that-lists-verified-vendors-with-basic-info-company-name-logo-when-present-verified-badge-and-allows-navigating-to-a-vendor-storefront-page",
      "title": "Add a new public Vendors directory page that lists verified vendors with basic info (company name, logo when present, verified badge) and allows navigating to a vendor storefront page.",
      "reqIds": [
        "REQ-23"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-public-vendor-storefront-page-that-shows-a-vendor-s-profile-company-name-logo-when-present-verified-badge-and-lists-that-vendor-s-published-products-with-navigation-to-each-product-detail-page",
      "title": "Add a public vendor storefront page that shows a vendor’s profile (company name, logo when present, verified badge) and lists that vendor’s published products, with navigation to each product detail page.",
      "reqIds": [
        "REQ-24"
      ],
      "version": 1
    },
    {
      "id": "feature-extend-frontend-react-query-marketplace-hooks-to-support-the-vendor-discovery-and-storefront-ui-verified-vendors-list-vendor-published-products-list-and-update-the-main-header-navigation-to-include-a-link-to-the-vendors-directory",
      "title": "Extend frontend React Query marketplace hooks to support the vendor discovery and storefront UI (verified vendors list + vendor published products list), and update the main header navigation to include a link to the Vendors directory.",
      "reqIds": [
        "REQ-25"
      ],
      "version": 1
    },
    {
      "id": "feature-wire-the-existing-frontend-vendor-profile-hooks-in-frontend-src-hooks-usemarketplacequeries-ts-to-the-new-backend-methods-enable-usecallervendorprofile-to-call-actor-getcallervendorprofile-and-enable-useupsertcallervendorprofile-to-call-actor-upsertcallervendorprofile-companyname-logourl-remove-the-current-placeholder-return-throw-paths",
      "title": "Wire the existing frontend vendor profile hooks in frontend/src/hooks/useMarketplaceQueries.ts to the new backend methods: enable useCallerVendorProfile() to call actor.getCallerVendorProfile(), and enable useUpsertCallerVendorProfile() to call actor.upsertCallerVendorProfile(companyName, logoUrl) (remove the current placeholder return/throw paths).",
      "reqIds": [
        "REQ-27"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-vendor-profile-ux-on-the-vendor-profile-page-frontend-src-pages-vendorprofilepage-tsx-to-correctly-handle-first-time-vendors-that-have-no-existing-profile-show-an-empty-form-that-can-be-saved-successfully-and-after-save-reload-and-display-the-saved-values-from-getcallervendorprofile",
      "title": "Update the vendor profile UX on the vendor profile page (frontend/src/pages/VendorProfilePage.tsx) to correctly handle first-time vendors that have no existing profile: show an empty form that can be saved successfully, and after save, reload and display the saved values from getCallerVendorProfile().",
      "reqIds": [
        "REQ-28"
      ],
      "version": 1
    },
    {
      "id": "feature-generate-a-small-set-of-marketplace-themed-placeholder-images-to-be-used-when-a-product-has-no-imageurl-and-or-a-vendor-has-no-logourl",
      "title": "Generate a small set of marketplace-themed placeholder images to be used when a product has no imageUrl and/or a vendor has no logoUrl.",
      "reqIds": [
        "REQ-29"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-public-product-browsing-and-product-detail-uis-to-use-the-generated-product-placeholder-image-instead-of-the-generic-icon-when-product-imageurl-is-missing-or-empty",
      "title": "Update the public product browsing and product detail UIs to use the generated product placeholder image instead of the generic icon when product.imageUrl is missing or empty.",
      "reqIds": [
        "REQ-30"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-vendors-directory-and-vendor-storefront-uis-to-use-the-generated-vendor-logo-placeholder-image-instead-of-the-generic-icon-when-vendor-logourl-is-missing-or-empty",
      "title": "Update the Vendors directory and Vendor storefront UIs to use the generated vendor logo placeholder image instead of the generic icon when vendor.logoUrl is missing or empty.",
      "reqIds": [
        "REQ-31"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-minimal-admin-facing-ui-section-to-support-manual-upgrade-verification-by-displaying-the-backend-upgrade-diagnostics-summary-and-short-instructions-for-checking-values-before-vs-after-an-upgrade",
      "title": "Add a minimal admin-facing UI section to support manual upgrade verification by displaying the backend upgrade diagnostics summary and short instructions for checking values before vs. after an upgrade.",
      "reqIds": [
        "REQ-56"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Phase 1 foundation: initialize marketplace project with two user types (admin, vendor) and scope limited to vendor onboarding + product listings (exclude payments, roles/permissions, analytics, DAOs, and multi-organization for now).",
      "reqIds": [],
      "status": "in_progress"
    },
    {
      "id": "AR-5",
      "summary": "Implement minimal backend health/debug endpoints to validate the frontend↔backend pipeline in Phase 1 (e.g., a ping or getBackendStatus call, plus an authenticated “whoami” returning the caller principal).",
      "reqIds": [
        "REQ-4"
      ],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Begin Phase 2 build/planning for the marketplace after completing the Phase 1 deployed scaffold (define and implement next-scope features beyond placeholders).",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Implement Phase 2 backend data models and APIs for vendor profiles and product listings, persisted in the single Motoko actor.",
      "reqIds": [
        "REQ-6"
      ],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Proceed with Phase 3 build/planning for the marketplace (next-scope features beyond Phase 2).",
      "reqIds": [],
      "status": "in_progress"
    },
    {
      "id": "AR-10",
      "summary": "Add a backend query API to resolve a vendor profile by owner principal so the public Product Detail page can show the vendor display name when available (principal -> vendor profile).",
      "reqIds": [
        "REQ-13"
      ],
      "status": "pending"
    },
    {
      "id": "AR-11",
      "summary": "Proceed with Phase 4 build/planning for the marketplace (next-scope features beyond Phase 3).",
      "reqIds": [],
      "status": "in_progress"
    },
    {
      "id": "AR-12",
      "summary": "Implement minimal backend health/debug query endpoints in the single Motoko actor to support frontend connection and identity checks: (1) a query method that returns backend status metadata (version and environment), (2) a query method that confirms the canister is reachable (ping), and (3) an authenticated query method that returns the caller principal (\"whoami\").",
      "reqIds": [
        "REQ-15"
      ],
      "status": "pending"
    },
    {
      "id": "AR-13",
      "summary": "Implement product data model and persisted storage in the single Motoko backend actor (backend/main.mo), including fields required by the existing frontend types: id, ownerPrincipal, title, description, price (in cents), currency, imageUrl, category, isPublished, createdAt, updatedAt.",
      "reqIds": [
        "REQ-18"
      ],
      "status": "pending"
    },
    {
      "id": "AR-14",
      "summary": "Add backend API methods for vendor product management and public browsing in backend/main.mo, and enforce authorization rules: (1) createProduct(...) (authenticated user; owner=caller), (2) updateProduct(productId, ...) (owner or admin), (3) getProductById(productId) (public), (4) getPublishedProducts() (public; only isPublished=true), and (5) getCallerProducts() (authenticated user; only caller-owned products).",
      "reqIds": [
        "REQ-19"
      ],
      "status": "pending"
    },
    {
      "id": "AR-15",
      "summary": "Add backend public query APIs to support a Phase 5 vendor discovery experience: (1) list verified vendor profiles, and (2) list published products for a specific vendor (by vendor user principal and/or vendorId) so the frontend can render vendor storefront pages.",
      "reqIds": [
        "REQ-22"
      ],
      "status": "pending"
    },
    {
      "id": "AR-16",
      "summary": "Add backend APIs in backend/main.mo for vendor self-service profile management for the authenticated caller: (1) getCallerVendorProfile() returning the caller’s VendorProfile (or null if none exists), and (2) upsertCallerVendorProfile(companyName, logoUrl) that creates a new VendorProfile for the caller if one does not exist, otherwise updates the existing caller-owned VendorProfile while preserving id, user principal, and current verification status.",
      "reqIds": [
        "REQ-26"
      ],
      "status": "pending"
    },
    {
      "id": "AR-17",
      "summary": "Add stable persistence for marketplace state in the single Motoko backend actor so that vendor profiles, products, and ID counters survive canister upgrades.",
      "reqIds": [
        "REQ-32"
      ],
      "status": "pending"
    },
    {
      "id": "AR-18",
      "summary": "Implement a conditional migration path for existing deployed state so current in-memory Map data can be preserved when transitioning to stable storage, following the platform migration policy (create backend/migration.mo only if needed).",
      "reqIds": [
        "REQ-33"
      ],
      "status": "pending"
    },
    {
      "id": "AR-19",
      "summary": "Implement stable persistence in backend/main.mo so marketplace state survives canister upgrades, including: userProfiles, vendors, products, and the ID counters (vendor and product).",
      "reqIds": [
        "REQ-34"
      ],
      "status": "pending"
    },
    {
      "id": "AR-20",
      "summary": "Add a conditional upgrade migration path that preserves existing deployed state when transitioning from the current in-memory Map-based storage to stable storage, following the platform migration policy (create backend/migration.mo only if needed).",
      "reqIds": [
        "REQ-35"
      ],
      "status": "pending"
    },
    {
      "id": "AR-21",
      "summary": "Implement stable persistence for all marketplace state in the single Motoko actor so that data survives canister upgrades, including: userProfiles, vendors, products, lastVendorId, and lastProductId.",
      "reqIds": [
        "REQ-36"
      ],
      "status": "pending"
    },
    {
      "id": "AR-22",
      "summary": "Add a conditional upgrade migration path that preserves existing deployed in-memory Map-based state when transitioning to stable storage, following the platform migration policy (create backend/migration.mo only if needed).",
      "reqIds": [
        "REQ-37"
      ],
      "status": "pending"
    },
    {
      "id": "AR-23",
      "summary": "Implement stable persistence for all marketplace state in the single Motoko actor (backend/main.mo) so that vendor profiles, products, user profiles, and ID counters survive canister upgrades.",
      "reqIds": [
        "REQ-38"
      ],
      "status": "pending"
    },
    {
      "id": "AR-24",
      "summary": "Add a conditional upgrade migration path that preserves existing deployed in-memory Map-based state when transitioning to stable storage, following the platform migration policy (create backend/migration.mo only if needed).",
      "reqIds": [
        "REQ-39"
      ],
      "status": "pending"
    },
    {
      "id": "AR-25",
      "summary": "Implement stable persistence in the single Motoko backend actor (backend/main.mo) so marketplace state survives canister upgrades, including: userProfiles, vendors, products, lastVendorId, and lastProductId.",
      "reqIds": [
        "REQ-40"
      ],
      "status": "pending"
    },
    {
      "id": "AR-26",
      "summary": "Add a conditional upgrade migration path (backend/migration.mo only if needed by the migration policy) that preserves existing deployed in-memory Map-based state when transitioning to stable storage.",
      "reqIds": [
        "REQ-41"
      ],
      "status": "pending"
    },
    {
      "id": "AR-27",
      "summary": "Implement stable persistence in the single Motoko backend actor (backend/main.mo) so marketplace state survives canister upgrades, including: userProfiles, vendors, products, lastVendorId, and lastProductId.",
      "reqIds": [
        "REQ-42"
      ],
      "status": "pending"
    },
    {
      "id": "AR-28",
      "summary": "Add or update a conditional upgrade migration path following the platform migration policy so existing deployed in-memory Map-based state is preserved when transitioning to stable storage (use backend/migration.mo only if needed by the policy).",
      "reqIds": [
        "REQ-43"
      ],
      "status": "pending"
    },
    {
      "id": "AR-29",
      "summary": "Persist all marketplace state across canister upgrades by moving the in-memory Map-based state in backend/main.mo into stable storage, including: userProfiles, vendors, products, lastVendorId, and lastProductId.",
      "reqIds": [
        "REQ-44"
      ],
      "status": "pending"
    },
    {
      "id": "AR-30",
      "summary": "Implement a conditional upgrade migration path that preserves already-deployed in-memory Map state when transitioning to stable storage, following the platform migration policy (create backend/migration.mo only if needed).",
      "reqIds": [
        "REQ-45"
      ],
      "status": "pending"
    },
    {
      "id": "AR-31",
      "summary": "Add minimal backend-level sanity checks/logging (non-user-facing) around upgrade hooks/migration to help diagnose upgrade issues without changing user-facing behavior.",
      "reqIds": [
        "REQ-46"
      ],
      "status": "pending"
    },
    {
      "id": "AR-32",
      "summary": "Persist all marketplace state in the single Motoko backend actor (backend/main.mo) so that data survives canister upgrades, including: access control state, userProfiles, vendors, products, lastVendorId, and lastProductId.",
      "reqIds": [
        "REQ-47"
      ],
      "status": "pending"
    },
    {
      "id": "AR-33",
      "summary": "Implement a conditional upgrade migration path to preserve already-deployed in-memory Map-based state when transitioning to stable storage, following the platform migration policy (create backend/migration.mo only if needed).",
      "reqIds": [
        "REQ-48"
      ],
      "status": "pending"
    },
    {
      "id": "AR-34",
      "summary": "Add minimal backend-level sanity checks/logging (non-user-facing) around upgrade hooks/migration to help diagnose upgrade issues without changing user-facing behavior.",
      "reqIds": [
        "REQ-49"
      ],
      "status": "pending"
    },
    {
      "id": "AR-35",
      "summary": "Persist all marketplace state across canister upgrades by moving the in-memory state in backend/main.mo into stable storage, including: access control state, userProfiles, vendors, products, lastVendorId, and lastProductId.",
      "reqIds": [
        "REQ-50"
      ],
      "status": "pending"
    },
    {
      "id": "AR-36",
      "summary": "Implement upgrade-safe serialization and restoration for backend state by adding system upgrade hooks in backend/main.mo (preupgrade/postupgrade) that correctly round-trip all persisted state.",
      "reqIds": [
        "REQ-51"
      ],
      "status": "pending"
    },
    {
      "id": "AR-37",
      "summary": "Add a conditional migration path following the platform migration policy to preserve already-deployed in-memory Map-based state when transitioning to stable storage; create backend/migration.mo only if required by the platform policy.",
      "reqIds": [
        "REQ-52"
      ],
      "status": "pending"
    },
    {
      "id": "AR-38",
      "summary": "Add minimal backend-level (non-user-facing) sanity checks/logging around upgrade hooks/migration to help diagnose upgrade issues without changing user-facing behavior.",
      "reqIds": [
        "REQ-53"
      ],
      "status": "pending"
    },
    {
      "id": "AR-39",
      "summary": "Implement upgrade-safe persistence for all backend state in backend/main.mo by moving the current in-memory state (Maps and counters) into stable storage and adding system preupgrade/postupgrade hooks that round-trip all data without loss.",
      "reqIds": [
        "REQ-54"
      ],
      "status": "pending"
    },
    {
      "id": "AR-40",
      "summary": "Add a backend upgrade diagnostics query API that exposes a small, non-sensitive state summary for manual verification before and after an upgrade (e.g., counts of vendors/products, and the lastVendorId/lastProductId values). If access control is required, restrict this endpoint to admin mode.",
      "reqIds": [
        "REQ-55"
      ],
      "status": "pending"
    },
    {
      "id": "AR-42",
      "summary": "If a conditional migration file is required by the platform migration policy for preserving already-deployed state, add or update backend/migration.mo so upgrades preserve existing deployed state when transitioning to stable storage.",
      "reqIds": [
        "REQ-57"
      ],
      "status": "pending"
    },
    {
      "id": "AR-43",
      "summary": "Phase 5 vendor discovery backend: add public query APIs listVerifiedVendors() and listPublishedProductsByVendor(vendorPrincipal) to support Vendors Directory and Vendor Storefront pages.",
      "reqIds": [],
      "status": "in_progress"
    },
    {
      "id": "AR-44",
      "summary": "Frontend vendor discovery wiring: add React Query hooks for verified vendors + vendor published products and wire them into the Vendors Directory + Vendor Storefront pages (including navigation link).",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-45",
      "summary": "Consolidated upgrade-safety pass: move all marketplace state (vendors/products/userProfiles/counters/access control as applicable) into stable storage, add preupgrade/postupgrade round-tripping, and add conditional migration.mo only if required by migration policy.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-46",
      "summary": "Admin upgrade-verification UI: add a minimal admin section/page to display the backend upgrade diagnostics summary and short before/after upgrade verification instructions.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-47",
      "summary": "Add upgrade-safe stable persistence to the Motoko canister so that all marketplace state survives canister upgrades, including: access control state, userProfiles, vendors, products, lastVendorId, and lastProductId.",
      "reqIds": [
        "REQ-58"
      ],
      "status": "pending"
    },
    {
      "id": "AR-48",
      "summary": "Implement a conditional upgrade migration path (backend/migration.mo only if required by the platform migration policy) to preserve already-deployed in-memory Map-based state when transitioning to the new stable persistence implementation.",
      "reqIds": [
        "REQ-59"
      ],
      "status": "pending"
    },
    {
      "id": "AR-49",
      "summary": "Add explicit Phase 5 vendor discovery query APIs in backend/main.mo that match the planned naming: (1) listVerifiedVendors() returning verified vendor profiles and (2) listPublishedProductsByVendor(vendorPrincipal) returning published products for a vendor principal; keep the existing vendor discovery APIs intact for backward compatibility.",
      "reqIds": [
        "REQ-60"
      ],
      "status": "pending"
    },
    {
      "id": "AR-50",
      "summary": "Persist all marketplace backend state across canister upgrades by moving the current in-memory state in backend/main.mo into stable storage and adding system upgrade hooks that round-trip the full state without data loss (including: accessControlState, userProfiles, vendors, products, lastVendorId, lastProductId).",
      "reqIds": [
        "REQ-61"
      ],
      "status": "pending"
    },
    {
      "id": "AR-51",
      "summary": "Add a conditional upgrade migration path following the platform migration policy to preserve already-deployed state when transitioning to the new stable persistence implementation; create backend/migration.mo only if required by the platform migration policy.",
      "reqIds": [
        "REQ-62"
      ],
      "status": "pending"
    },
    {
      "id": "AR-52",
      "summary": "Add minimal, non-user-facing backend sanity checks/logging around upgrade hooks/migration to help diagnose upgrade issues without changing user-facing behavior.",
      "reqIds": [
        "REQ-63"
      ],
      "status": "pending"
    },
    {
      "id": "AR-53",
      "summary": "Make all backend marketplace state upgrade-safe by persisting it in stable storage and round-tripping it through system upgrade hooks in backend/main.mo, so canister upgrades do not lose access control, vendor profiles, products, user profiles, or ID counters.",
      "reqIds": [
        "REQ-64"
      ],
      "status": "pending"
    },
    {
      "id": "AR-54",
      "summary": "If required by the platform's conditional migration policy, add or update backend/migration.mo to preserve already-deployed state when transitioning from the current in-memory Map-based state to the new stable persistence implementation.",
      "reqIds": [
        "REQ-65"
      ],
      "status": "pending"
    },
    {
      "id": "AR-55",
      "summary": "Add minimal, non-user-facing backend sanity checks/logging around upgrade hooks (preupgrade/postupgrade and any migration) to help diagnose upgrade issues without changing user-facing behavior or exposing sensitive data.",
      "reqIds": [
        "REQ-66"
      ],
      "status": "pending"
    },
    {
      "id": "AR-56",
      "summary": "Persist all marketplace backend state across canister upgrades by moving the current in-memory state in backend/main.mo into stable storage and adding system upgrade hooks (preupgrade/postupgrade) that round-trip the full state without data loss (including: access control state, userProfiles, vendors, products, lastVendorId, lastProductId).",
      "reqIds": [
        "REQ-67"
      ],
      "status": "pending"
    },
    {
      "id": "AR-57",
      "summary": "Implement a conditional upgrade migration path that preserves already-deployed state when transitioning to the new stable persistence implementation, following the platform migration policy (create or update backend/migration.mo only if required by the policy).",
      "reqIds": [
        "REQ-68"
      ],
      "status": "pending"
    },
    {
      "id": "AR-58",
      "summary": "Add minimal, non-user-facing backend sanity checks/logging around upgrade hooks/migration to help diagnose upgrade issues without changing user-facing behavior or exposing sensitive data.",
      "reqIds": [
        "REQ-69"
      ],
      "status": "pending"
    },
    {
      "id": "AR-59",
      "summary": "Persist all marketplace backend state across canister upgrades by moving the current in-memory state in backend/main.mo into stable storage and adding system upgrade hooks (preupgrade/postupgrade) that round-trip the full state without data loss (including: accessControlState, userProfiles, vendors, products, lastVendorId, lastProductId).",
      "reqIds": [
        "REQ-70"
      ],
      "status": "pending"
    },
    {
      "id": "AR-60",
      "summary": "Implement a conditional upgrade migration path that preserves already-deployed in-memory Map-based state when transitioning to the new stable persistence implementation, following the platform migration policy (create or update backend/migration.mo only if required by the policy).",
      "reqIds": [
        "REQ-71"
      ],
      "status": "pending"
    },
    {
      "id": "AR-61",
      "summary": "Add minimal, non-user-facing backend sanity checks/logging around upgrade hooks (and any migration, if present) to help diagnose upgrade issues without exposing sensitive data or changing user-facing behavior.",
      "reqIds": [
        "REQ-72"
      ],
      "status": "pending"
    },
    {
      "id": "AR-62",
      "summary": "Persist all backend marketplace state across canister upgrades by moving the current in-memory state in backend/main.mo into stable storage, and implement system upgrade hooks (preupgrade/postupgrade) that correctly round-trip the full state without data loss (including: accessControlState, userProfiles, vendors, products, lastVendorId, lastProductId).",
      "reqIds": [
        "REQ-73"
      ],
      "status": "pending"
    },
    {
      "id": "AR-63",
      "summary": "Implement a conditional upgrade migration path that preserves already-deployed in-memory Map-based state when transitioning to the new stable persistence implementation, following the platform migration policy (create or update backend/migration.mo only if required by the policy).",
      "reqIds": [
        "REQ-74"
      ],
      "status": "pending"
    },
    {
      "id": "AR-64",
      "summary": "Add minimal, non-user-facing backend sanity checks/logging around upgrade hooks and any migration logic to help diagnose upgrade issues without exposing sensitive data or changing user-facing behavior.",
      "reqIds": [
        "REQ-75"
      ],
      "status": "pending"
    },
    {
      "id": "AR-65",
      "summary": "Persist all marketplace backend state across canister upgrades by moving the current in-memory state in backend/main.mo into stable storage and implementing system upgrade hooks (preupgrade/postupgrade) that round-trip the full state without data loss, including: accessControlState, userProfiles, vendors, products, lastVendorId, and lastProductId.",
      "reqIds": [
        "REQ-76"
      ],
      "status": "pending"
    },
    {
      "id": "AR-66",
      "summary": "Implement a conditional upgrade migration path that preserves already-deployed in-memory Map-based state when transitioning to the new stable persistence implementation, following the platform migration policy (create or update backend/migration.mo only if required by the policy).",
      "reqIds": [
        "REQ-77"
      ],
      "status": "pending"
    },
    {
      "id": "AR-67",
      "summary": "Add minimal, non-user-facing backend sanity checks/logging around upgrade hooks and any migration logic to help diagnose upgrade issues without exposing sensitive data or changing user-facing behavior.",
      "reqIds": [
        "REQ-78"
      ],
      "status": "pending"
    },
    {
      "id": "AR-68",
      "summary": "Persist all marketplace backend state across canister upgrades by moving the current in-memory state in backend/main.mo into stable storage and implementing system upgrade hooks (preupgrade/postupgrade) that correctly round-trip the full state without data loss, including: accessControlState, userProfiles, vendors, products, lastVendorId, lastProductId, and any backend metadata needed for normal operation.",
      "reqIds": [
        "REQ-79"
      ],
      "status": "pending"
    },
    {
      "id": "AR-69",
      "summary": "Implement a conditional upgrade migration path that preserves already-deployed state when transitioning from the current in-memory Map-based state to the new stable persistence implementation, following the platform migration policy (create or update backend/migration.mo only if required by the policy).",
      "reqIds": [
        "REQ-80"
      ],
      "status": "pending"
    },
    {
      "id": "AR-70",
      "summary": "Add minimal, non-user-facing backend sanity checks/logging around upgrade hooks (and any migration, if present) to help diagnose upgrade issues without changing user-facing behavior or exposing sensitive data.",
      "reqIds": [
        "REQ-81"
      ],
      "status": "pending"
    },
    {
      "id": "AR-71",
      "summary": "Ensure the existing admin-only upgrade diagnostics endpoint (getUpgradeSummary) accurately reflects the persisted state after upgrades (counts and counters match reality) so the Admin Dashboard upgrade verification UI can be used to validate upgrade preservation before vs. after deployments.",
      "reqIds": [
        "REQ-82"
      ],
      "status": "pending"
    },
    {
      "id": "AR-72",
      "summary": "Persist all marketplace backend state across canister upgrades by moving the current in-memory state in backend/main.mo into stable storage and implementing system upgrade hooks (preupgrade/postupgrade) that correctly round-trip the full state without data loss (including: accessControlState, userProfiles, vendors, products, lastVendorId, lastProductId, and any backend metadata needed for normal operation).",
      "reqIds": [
        "REQ-83"
      ],
      "status": "pending"
    },
    {
      "id": "AR-73",
      "summary": "Implement a conditional upgrade migration path that preserves already-deployed in-memory Map-based state when transitioning to the new stable persistence implementation, following the platform migration policy (create or update backend/migration.mo only if required by the policy).",
      "reqIds": [
        "REQ-84"
      ],
      "status": "pending"
    },
    {
      "id": "AR-74",
      "summary": "Add minimal, non-user-facing backend sanity checks/logging around upgrade hooks (and any migration, if present) to help diagnose upgrade issues without exposing sensitive data or changing user-facing behavior.",
      "reqIds": [
        "REQ-85"
      ],
      "status": "pending"
    },
    {
      "id": "AR-75",
      "summary": "Ensure the existing admin-only upgrade diagnostics endpoint getUpgradeSummary accurately reflects the persisted state after upgrades (counts and counters match reality) so the Admin Dashboard upgrade verification UI can be used to validate upgrade preservation before vs. after deployments.",
      "reqIds": [
        "REQ-86"
      ],
      "status": "pending"
    }
  ],
  "projectName": "Phase 1 Foundation: Marketplace app scaffold with Admin/Vendor entry and basic navigation",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}